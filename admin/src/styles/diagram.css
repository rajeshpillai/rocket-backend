@layer components {
  /* Paper view — full-page overlay (Basecamp style) */
  .paper-view {
    @apply fixed inset-0 z-50 flex flex-col;
    background-color: #f5f5f0;
  }

  .paper-header {
    @apply flex items-center justify-between px-6 py-3 shrink-0;
    background-color: #fff;
    border-bottom: 1px solid #e8e8e3;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
  }

  .paper-header-left {
    @apply flex items-center gap-3;
  }

  .paper-header-right {
    @apply flex items-center gap-2;
  }

  .paper-back-btn {
    @apply flex items-center gap-1.5 text-sm text-gray-500
           hover:text-gray-900 cursor-pointer transition-colors
           px-2 py-1 rounded hover:bg-gray-100;
  }

  .paper-title {
    @apply text-base font-semibold text-gray-900;
  }

  .paper-subtitle {
    @apply text-xs text-gray-400 font-normal ml-2;
  }

  .paper-body {
    @apply flex flex-col flex-1 overflow-hidden;
  }

  /* Metadata panel — collapsible bar below header */
  .metadata-panel {
    @apply shrink-0 overflow-hidden transition-all duration-200;
    background-color: #fff;
    border-bottom: 1px solid #e8e8e3;
  }

  .metadata-panel-inner {
    @apply px-6 py-3 flex flex-wrap gap-x-4 gap-y-2 items-end;
  }

  .metadata-field {
    @apply flex flex-col gap-0.5;
    min-width: 140px;
  }

  .metadata-field-wide {
    @apply flex flex-col gap-0.5;
    min-width: 200px;
  }

  .metadata-label {
    @apply text-xs font-medium text-gray-500;
  }

  .metadata-input {
    @apply text-sm border border-gray-200 rounded px-2 py-1
           bg-white text-gray-900 outline-none
           focus:border-blue-400 focus:ring-1 focus:ring-blue-100;
  }

  .metadata-select {
    @apply text-sm border border-gray-200 rounded px-2 py-1
           bg-white text-gray-900 outline-none cursor-pointer
           focus:border-blue-400 focus:ring-1 focus:ring-blue-100;
  }

  .metadata-toggle {
    @apply flex items-center gap-2 pb-1;
  }

  /* Toolbar dropdown */
  .toolbar-dropdown {
    @apply relative;
  }

  .toolbar-dropdown-menu {
    @apply absolute right-0 top-full mt-1 bg-white border border-gray-200
           rounded-md shadow-lg py-1 z-20 min-w-36;
  }

  .toolbar-dropdown-item {
    @apply block w-full text-left px-3 py-1.5 text-sm text-gray-700
           hover:bg-gray-50 cursor-pointer transition-colors;
  }

  /* Diagram layout */
  .diagram-container {
    @apply flex flex-1 overflow-hidden;
  }

  .diagram-canvas-wrap {
    @apply flex-1 relative overflow-hidden;
    background-color: #f8f8f4;
    background-image:
      radial-gradient(circle, #ddd 1px, transparent 1px);
    background-size: 24px 24px;
  }

  .diagram-canvas-wrap svg {
    @apply w-full h-full;
    cursor: grab;
  }

  .diagram-canvas-wrap svg:active {
    cursor: grabbing;
  }

  .diagram-toolbar {
    @apply absolute top-3 right-3 flex gap-1 z-10;
  }

  .diagram-toolbar button {
    @apply bg-white border border-gray-200 rounded px-2.5 py-1
           text-xs text-gray-600 hover:bg-gray-50 hover:text-gray-900
           shadow-sm transition-colors cursor-pointer;
  }

  /* Property panel (editable) */
  .diagram-property-panel {
    @apply w-80 border-l overflow-y-auto p-4
           flex flex-col gap-3 shrink-0;
    background-color: #fff;
    border-color: #e8e8e3;
  }

  .diagram-property-header {
    @apply flex items-center justify-between pb-2 border-b border-gray-100;
  }

  .diagram-property-title {
    @apply text-sm font-semibold text-gray-900;
  }

  .diagram-property-close {
    @apply text-gray-400 hover:text-gray-600 cursor-pointer p-1
           rounded hover:bg-gray-100 transition-colors text-xs;
  }

  .diagram-property-section {
    @apply flex flex-col gap-1;
  }

  .diagram-property-label {
    @apply text-xs font-medium text-gray-500 uppercase tracking-wide;
  }

  .diagram-property-value {
    @apply text-sm text-gray-900 bg-gray-50 rounded px-2 py-1.5
           border border-gray-100 font-mono;
  }

  .diagram-property-badge {
    @apply text-xs font-medium px-2 py-0.5 rounded-full inline-block;
  }

  /* Action card in editable panel */
  .action-card {
    @apply border border-gray-200 rounded p-2 flex flex-col gap-1.5 bg-gray-50;
  }

  .action-card-header {
    @apply flex items-center justify-between;
  }

  .action-remove-btn {
    @apply text-xs text-red-400 hover:text-red-600 cursor-pointer;
  }

  /* Transition card in state machine panel */
  .transition-card {
    @apply border border-gray-200 rounded p-2 flex flex-col gap-1.5 bg-gray-50;
  }

  .transition-card-header {
    @apply flex items-center justify-between text-xs text-gray-500;
  }

  /* Delete button */
  .panel-delete-btn {
    @apply mt-2 w-full text-center text-xs text-red-500 border border-red-200
           rounded py-1.5 hover:bg-red-50 hover:text-red-700 cursor-pointer
           transition-colors;
  }

  /* Add button */
  .panel-add-btn {
    @apply text-xs text-blue-600 hover:text-blue-800 cursor-pointer
           flex items-center gap-1;
  }

  .diagram-empty {
    @apply flex flex-1 items-center justify-center text-gray-400 text-sm;
  }

  /* SVG node styles */
  .diagram-node {
    cursor: pointer;
  }

  .diagram-node:hover rect,
  .diagram-node:hover polygon,
  .diagram-node:hover circle {
    filter: brightness(0.95);
  }

  .diagram-edge-label {
    font-size: 11px;
    fill: #6b7280;
    pointer-events: none;
  }
}
